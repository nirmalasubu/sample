machine:
  pre:
    # install newer docker
    - sudo curl -L -o /usr/bin/docker 'https://s3-external-1.amazonaws.com/circle-downloads/docker-1.10.0-circleci'
    - echo 'DOCKER_OPTS="-s btrfs -D"' | sudo tee /etc/default/docker
    - echo 'env container=yes' | sudo tee -a /etc/init/docker.conf

    # install newer docker-compose
    - sudo pip install docker-compose
    - sudo sh -c 'echo "deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ trusty main" > /etc/apt/sources.list.d/dotnetdev.list'
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 417A0893
    - sudo apt-get update  
    - sudo apt-get install dotnet-dev-1.0.0-preview2.1-003177

  services:
    - docker
    
test:
  override:
    - docker info
    - docker version

    #- docker build --rm=false -t odtapi .
    #- docker run --name odtapicontainer -p 5000:5000 odtapi && sleep 10
    #- curl --retry 10 --retry-delay 5 -v http://localhost:5000/api/values